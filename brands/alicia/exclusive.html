<link rel="stylesheet" href="//static.zalora.com/css/global.css">
<link rel="stylesheet" href="//static.zalora.com/css/onsite.css">

<style>
    .cms-sis-cat-name {
        display: inline-block;
        background: #FFF;
        color: #000;
        line-height: 1.6em;
        font-family: Apercu, Arial, sans-serif;
        font-size: 14px;
        padding: 6px 20px;
        text-transform: uppercase;
        letter-spacing: 1px
    }
    .cms-sis-cat-lg {
        width: 237px;
        height: 482px;
    }
    .cms-sis-cat-lg:hover, .cms-sis-cat-sm:hover, .cms-banner-bg:hover, .cms-theme-lg:hover {
        cursor: pointer;
        opacity: .8;
    }
    .cms-sis-cat-lg:hover .cms-sis-cat-name, .cms-sis-cat-sm:hover .cms-sis-cat-name {
        background: #000;
        color: #FFF
    }
    .cms-sis-cat-lg-pos {
        padding-top: 427px
    }
    ul.cms-tabs li.cms-sis-tabs {
        border-top: 1px solid #000; 
        border-left: 1px solid #000; 
        border-right: 1px solid #000; 
        padding: 10px 15px;
        letter-spacing: 2px;
        font-size: 14px;
    }
    .cms-hero-bg {
        width: 996px;
        height: 500px;
    }
    .cms-banner-bg:hover .btn {
        color: #000;
        background: transparent;
    }
    .cms-hero-content-pos {
        padding-left: 220px;
        padding-top: 280px
    }
    body {
        background:#fff!important;
    }

    .cms-sis-cat-sm {
        width: 237px;
        height: 230px;
    }

    .cms-sis-cat-sm-pos {
        padding-top: 179px
    }

    .cms-sis-cat-sm-spacer {
        width: 100%;
        height: 16px
    }
    .cms-sis-half-hero {
        width: 996px;
        height: 250px;
    }
</style>
<div class="cms-container" id="cms-warehousesis">

    <div class="cms-row">
        <a id="js-sis-Hero-exiturl" href="">
            <div class="cms-full">
                <div id="js-sis-Hero-img" class="cms-hero-bg cms-animate" data-load="lazy" data-bg=""></div>
            </div>
        </a>
    </div>

    <div class="cms-full mtxxl txtCenter">
        <div class="cms-sis-section-heading">
            SHOP BY CATEGORY
        </div>
        <div class="cms-spacer-25"></div>

        <!-- Women's Tab -->
        <div class="cms-full cms-tab-content current" id="jsTab-1">
            <div class="cms-full">
                <div class="lfloat">
                    <a id="js-sis-SB1-exiturl" href="">  
                        <div id="js-sis-SB1-img"  class="cms-sis-cat-lg txtCenter cms-animate" data-load="lazy" data-bg="">
                            <div class="cms-sis-cat-lg-pos">
                                <div id="js-sis-SB1-namecopy" class="cms-sis-cat-name"></div>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="lfloat cms-spacer-grid">
                    <a id="js-sis-SB2-exiturl" href=""> 
                        <div id="js-sis-SB2-img"  class="cms-sis-cat-sm txtCenter cms-animate" data-load="lazy" data-bg="">
                            <div class="cms-sis-cat-sm-pos">
                                <div id="js-sis-SB2-namecopy" class="cms-sis-cat-name"></div>
                            </div>
                        </div>
                    </a>
                    <div class="cms-sis-cat-sm-spacer"></div>
                    <a id="js-sis-SB3-exiturl" href=""> 
                        <div id="js-sis-SB3-img"  class="cms-sis-cat-sm txtCenter cms-animate" data-load="lazy" data-bg="">
                            <div class="cms-sis-cat-sm-pos">
                                <div id="js-sis-SB3-namecopy" class="cms-sis-cat-name"></div>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="lfloat cms-spacer-grid">
                    <a id="js-sis-SB4-exiturl" href="">  
                        <div id="js-sis-SB4-img"  class="cms-sis-cat-lg txtCenter cms-animate" data-load="lazy" data-bg="">
                            <div class="cms-sis-cat-lg-pos">
                                <div id="js-sis-SB4-namecopy" class="cms-sis-cat-name"></div>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="lfloat cms-spacer-grid">
                    <a id="js-sis-SB5-exiturl" href=""> 
                        <div id="js-sis-SB5-img" class="cms-sis-cat-sm txtCenter cms-animate" data-load="lazy" data-bg="">
                            <div class="cms-sis-cat-sm-pos">
                                <div id="js-sis-SB5-namecopy" class="cms-sis-cat-name"></div>
                            </div>
                        </div>
                    </a>
                    <div class="cms-sis-cat-sm-spacer"></div>
                    <a id="js-sis-SB6-exiturl" href=""> 
                        <div id="js-sis-SB6-img" class="cms-sis-cat-sm txtCenter cms-animate" data-load="lazy" data-bg="">
                            <div class="cms-sis-cat-sm-pos">
                                <div id="js-sis-SB6-namecopy" class="cms-sis-cat-name"></div>
                            </div>
                        </div>
                    </a>
                </div>
            </div> 
        </div>
    </div>

    <!-- Half Hero -->
    <div class="cms-row">
        <div class="cms-full mtxxl">
            <a id="js-sis-HH-exiturl" href="">
                <div class="cms-sis-half-hero" id="js-sis-HH-img" data-load="lazy" data-bg=""></div>
            </a>
        </div>
    </div>    

    <!-- About -->
    <div class="cms-row">
        <div class="cms-full mtxxl txtCenter">
            <div class="cms-sis-section-heading">
                About
            </div>
            <div class="cms-spacer-25"></div>
        </div>
        <div class="cms-full mbxxl">
            <div class="cms-video-floater">
                <iframe id="js-sis-vid" width="620" height="349" src="" frameborder="0" allowfullscreen=""></iframe>
            </div>
            <div class="cms-video-text-floater">
                <div id="js-sis-bdesc" class="cms-about-text">
                </div>
            </div>
        </div>
    </div>

</div>

<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>
    function fetchDataFromExcel(spreadsheet, worksheet) {
        var createLooperObject = [];
        var fetchedData;
        var spreadsheetID = spreadsheet; 
        var worksheetID = worksheet;
        var url = "https://spreadsheets.google.com/feeds/list/" + spreadsheetID + "/" + worksheetID + "/public/values?alt=json";
        $.getJSON(url, function (data) {
            fetchedData = data.feed.entry;
            for (var i = 0; i < fetchedData.length; i++) {
                createLooperObject.push(
                        {
                            placement: fetchedData[i]['gsx$placement']['$t'],
                            imageURL: fetchedData[i]['gsx$image']['$t'],
                            exitURL: fetchedData[i]['gsx$exiturl']['$t'],
                            subcatNameCopy: fetchedData[i]['gsx$subcatname']['$t']
                        }
                );
            }
            console.log(createLooperObject);

            displayDataUsingHandlebars(createLooperObject);

        });
    }

    function displayDataUsingHandlebars(data) {
        for (var i = 0; i < data.length - 2; i++) {
            var curplacecode = "js-sis-" + data[i]['placement'] + "-img";
            var curplaceimg = $("#js-sis-" + data[i]['placement'] + "-img");
            curplaceimg.attr("data-bg", data[i]['imageURL']);

            document.getElementById('' + curplacecode).style.backgroundImage = 'url(' + curplaceimg.attr("data-bg") + ')';

            $("#js-sis-" + data[i]['placement'] + "-exiturl").attr("href", data[i]['exitURL']);
            $("#js-sis-" + data[i]['placement'] + "-namecopy").html(data[i]['subcatNameCopy']);
        }

        $("#js-sis-" + data[8]['placement']).attr("src", data[8]['imageURL']);
        $("#js-sis-" + data[9]['placement']).text("" + data[9]['imageURL']);
    }

    $(function () {
        fetchDataFromExcel(getURLParameter("brand"), getURLParameter("sheet"));
    });


    function getURLParameter(theParameter) {
        var params = window.location.search.substr(1).split('&');

        for (var i = 0; i < params.length; i++) {
            var p = params[i].split('=');
            if (p[0] == theParameter) {
                return decodeURIComponent(p[1]);
            }
        }
        return false;
    }
</script>